defaultNamespace: loki
# Custom helm options
helm:
  releaseName: loki
  chart: loki
  repo: https://grafana.github.io/helm-charts
  version: 5.2.0
  values:
    loki:
      auth_enabled: false
    minio:
      enabled: true
    global:
      dnsService: rke2-coredns-rke2-coredns
    monitoring:
      dashboards:
        namespace: cattle-dashboards
dependsOn:
  - name: dgiebert-fleet-rancher-monitoring-app

# Patches needed for Fleet
diff:
  comparePatches:
  - apiVersion: apps/v1
    kind: StatefulSet
    name: loki-read
    namespace: loki
    operations:
    - {"op": "remove", "path":"/spec/persistentVolumeClaimRetentionPolicy"}
  - apiVersion: apps/v1
    kind: StatefulSet
    name: loki-backend
    namespace: loki
    operations:
    - {"op": "remove", "path":"/spec/persistentVolumeClaimRetentionPolicy"}